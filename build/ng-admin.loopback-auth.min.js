/*! ng-admin.loopback-auth 2016-07-12 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(a,b){return{authenticate:function(c,d,e){var f=b.getAuthURL();return a({url:f,method:"POST",headers:{"Content-Type":"application/json"},data:c}).then(function(c){localStorage.userToken=c.data.id,d(c);var e=b.getCustomAuthHeader();e?a.defaults.headers.common[e.name]=e.template.replace("{{token}}",c.data.token):a.defaults.headers.common.Authorization=c.data.id},e)},isAuthenticated:function(){return!!localStorage.userToken},logout:function(){return localStorage.removeItem("userToken"),!0}}};d.$inject=["$http","ngAdminJWTAuthConfigurator"],b.exports=d},{}],2:[function(a,b,c){var d=function(){var a={_nonProtectedStates:["login"]};this.setJWTAuthURL=function(b){a._authUrl=b},this.setCustomLoginTemplate=function(b){a._customLoginTemplate=b},this.setLoginSuccessCallback=function(b){a._loginSuccessCallback=b},this.setLoginErrorCallback=function(b){a._loginErrorCallback=b},this.setCustomAuthHeader=function(b){return a._customAuthHeader=b},this.setNonProtectedStates=function(b){b.push("login"),a._nonProtectedStates=b},this.setCheckEveryResponseForAuthHeader=function(){a._checkEveryResponseForAuthHeader=!0},this.$get=function(){return{getAuthURL:function(){return a._authUrl},getCustomLoginTemplate:function(){return a._customLoginTemplate},getLoginSuccessCallback:function(){return a._loginSuccessCallback},getLoginErrorCallback:function(){return a._loginErrorCallback},getCustomAuthHeader:function(){return a._customAuthHeader},getNonProtectedStates:function(){return a._nonProtectedStates},getCheckEveryResponseForAuthHeader:function(){return!!a._checkEveryResponseForAuthHeader}}}};b.exports=d},{}],3:[function(a,b,c){var d=function(a,b,c,d,e,f){this.$scope=a,this.$rootScope=b,this.ngAdminJWTAuthService=c,this.ngAdminJWTAuthConfigurator=d,this.notification=e,this.$location=f};d.prototype.login=function(){var a=this,b=this.ngAdminJWTAuthConfigurator.getLoginSuccessCallback()||function(b){a.notification.log("Successful login",{addnCls:"humane-flatty-success"}),a.$location.path("/dashboard")},c=this.ngAdminJWTAuthConfigurator.getLoginErrorCallback()||function(b){a.notification.log(b.data.error.message,{addnCls:"humane-flatty-error"})};this.ngAdminJWTAuthService.authenticate(this.data,b,c)},d.$inject=["$rootScope","$scope","ngAdminJWTAuthService","ngAdminJWTAuthConfigurator","notification","$location"],b.exports=d},{}],4:[function(a,b,c){var d='<div class="container">\n    <form style="max-width: 330px; padding: 15px; margin: 0 auto;" class="form-login" name="loginController.form"  ng-submit="loginController.login()">\n        <h2 class="form-login-heading">Please log in</h2>\n        <div class="form-group">\n            <label for="inputLogin" class="sr-only">Login</label>\n            <input type="text" id="inputLogin" class="form-control" placeholder="Login" ng-model="loginController.data.login" ng-required="true" ng-minlength="3" ng-enter="loginController.login()">\n        </div>\n        <div class="form-group">\n            <label for="inputPassword" class="sr-only">Password</label>\n            <input type="password" id="inputPassword" class="form-control" placeholder="Password" ng-model="loginController.data.password" ng-required="true" ng-minlength="4" ng-enter="loginController.login()">\n        </div>\n\n        <button class="btn btn-lg btn-primary btn-block" type="submit" ng-disabled="loginController.form.$invalid">Login</button>\n    </form>\n</div>';b.exports=d},{}],5:[function(a,b,c){var d=function(a,b,c){b.logout(),c.path("/login")};d.$inject=["$scope","ngAdminJWTAuthService","$location"],b.exports=d},{}],6:[function(a,b,c){"use strict";var d=angular.module("ng-admin.jwt-auth",[]);d.config(["$stateProvider","$httpProvider",function(b,c){b.state("login",{parent:"",url:"/login",controller:"loginController",controllerAs:"loginController",templateProvider:["ngAdminJWTAuthConfigurator","$http","notification",function(b,c,d){var e=b.getCustomLoginTemplate();return e?e.endsWith(".html")?c.get(e).then(function(a){return a.data},function(a){d.log("Error in template loading",{addnCls:"humane-flatty-error"})}):e:a("./loginTemplate")}]}),b.state("logout",{parent:"",url:"/logout",controller:"logoutController",controllerAs:"logoutController"})}]),d.run(["$q","Restangular","ngAdminJWTAuthService","$http","$location","$state","$rootScope","ngAdminJWTAuthConfigurator",function(a,b,c,d,e,f,g,h){g.$on("$stateChangeStart",function(a,b,d,e,i){if(!c.isAuthenticated()){var j=h.getNonProtectedStates();if(j.indexOf(b.name)==-1){a.preventDefault();var k=f.go("login");k.then(function(){g.$broadcast("$stateChangeSuccess",b.self,d,e.self,i)})}return!0}return!0}),b.setErrorInterceptor(function(a,b,c){return 401!==a.status||(localStorage.removeItem("userToken"),e.path("/login"),!1)}),b.addFullRequestInterceptor(function(a,b,e){if(c.isAuthenticated()){var f=h.getCustomAuthHeader();f?d.defaults.headers.common[f.name]=f.template.replace("{{token}}",localStorage.userToken):d.defaults.headers.common.Authorization=localStorage.userToken}}),h.getCheckEveryResponseForAuthHeader()&&b.addResponseInterceptor(function(a,b,d,e,f){if(c.isAuthenticated()){var g,i=h.getCustomAuthHeader();i&&f.headers(i.name)?(g=f.headers(i.name),g=g.replace(i.template.replace("{{token}}",""),"")):f.headers("Authorization")&&(g=f.headers("Authorization"),g=g.replace("Basic ","")),g&&(localStorage.userToken=g)}return a})}]),d.controller("loginController",a("./loginController")),d.controller("logoutController",a("./logoutController")),d.provider("ngAdminJWTAuthConfigurator",a("./configuratorProvider")),d.service("ngAdminJWTAuthService",a("./authService"))},{"./authService":1,"./configuratorProvider":2,"./loginController":3,"./loginTemplate":4,"./logoutController":5}]},{},[1,2,3,4,5,6]);